<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>ISA CULTURAL FEST 2026 | THE LEGACY</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Instrument+Serif:ital@0;1&family=Inter:wght@200;400&family=Bodoni+Moda:ital,wght@0,400;1,700&display=swap" rel="stylesheet">
    
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <style>
        :root {
            --gold: #D4AF37; /* More metallic prestige gold */
            --gold-dim: #8a6d2b;
            --obsidian: #050505;
            --bone: #fcfaf5;
            --border-alpha: rgba(212, 175, 55, 0.2);
        }

        * { box-sizing: border-box; cursor: none; }
        
        body {
            margin: 0; font-family: 'Inter', sans-serif;
            background-color: var(--obsidian);
            color: var(--bone);
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* PRESTIGE CURSOR */
        #cursor { position: fixed; width: 6px; height: 6px; background: var(--gold); border-radius: 50%; pointer-events: none; z-index: 9999; }
        #cursor-follower { 
            position: fixed; width: 50px; height: 50px; border: 0.5px solid var(--gold); 
            border-radius: 50%; pointer-events: none; z-index: 9998; 
            transition: transform 0.2s cubic-bezier(0.23, 1, 0.32, 1); 
        }

        /* HERO - CINEMATIC ENTRANCE */
        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, var(--obsidian) 80%);
        }

        .hero-title { 
            font-family: 'Instrument Serif', serif; 
            font-size: clamp(4rem, 18vw, 12rem); 
            font-style: italic; 
            margin: 0; 
            color: var(--gold);
            line-height: 0.8;
            letter-spacing: -2px;
        }

        .hero-label {
            font-family: 'Syncopate';
            font-size: 0.6rem;
            letter-spacing: 1.5rem;
            margin-bottom: 30px;
            color: var(--gold-dim);
            text-transform: uppercase;
        }

        /* THE CHRONICLE REGISTRY - HIGH END FORM */
        .registry-section {
            padding: 150px 0;
            border-top: 1px solid var(--border-alpha);
            display: flex;
            justify-content: center;
        }

        .registry-card {
            width: 100%;
            max-width: 1100px;
            padding: 80px;
            background: rgba(255,255,255,0.02);
            border: 1px solid var(--border-alpha);
            backdrop-filter: blur(10px);
        }

        .form-header {
            font-family: 'Bodoni Moda';
            font-size: 3rem;
            font-style: italic;
            margin-bottom: 60px;
            border-bottom: 1px solid var(--border-alpha);
            padding-bottom: 30px;
            text-align: center;
        }

        /* LUXURY INPUTS */
        .input-row { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 40px; }
        
        label { 
            font-family: 'Syncopate'; 
            font-size: 0.5rem; 
            color: var(--gold-dim); 
            display: block; 
            margin-bottom: 15px; 
            letter-spacing: 4px;
        }

        select, input, textarea {
            width: 100%;
            background: transparent;
            border: none;
            border-bottom: 1px solid var(--border-alpha);
            padding: 15px 0;
            font-family: 'Inter';
            font-weight: 200;
            font-size: 1.1rem;
            color: var(--bone);
            transition: 0.5s;
        }

        select:focus, input:focus, textarea:focus { 
            outline: none; 
            border-bottom: 1px solid var(--gold);
            background: rgba(212, 175, 55, 0.03);
        }

        .submit-btn {
            width: 100%;
            background: transparent;
            color: var(--gold);
            border: 1px solid var(--gold);
            padding: 30px;
            font-family: 'Syncopate';
            font-size: 0.7rem;
            letter-spacing: 8px;
            transition: 0.6s cubic-bezier(0.19, 1, 0.22, 1);
            margin-top: 40px;
        }

        .submit-btn:hover:not(:disabled) { 
            background: var(--gold); 
            color: var(--obsidian);
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.2);
        }

        /* THE FEED - ART GALLERY STYLE */
        .feed-item {
            padding: 120px 0;
            border-bottom: 1px solid var(--border-alpha);
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }

        .meta-header {
            font-family: 'Syncopate';
            font-size: 0.55rem;
            color: var(--gold-dim);
            margin-bottom: 30px;
            letter-spacing: 5px;
        }

        .quote-text {
            font-family: 'Instrument Serif';
            font-size: clamp(2rem, 5vw, 4rem);
            font-style: italic;
            line-height: 1.1;
            margin-bottom: 30px;
            color: var(--bone);
        }

        .signature-line {
            font-family: 'Bodoni Moda';
            font-size: 1rem;
            opacity: 0.5;
            letter-spacing: 2px;
        }

        .redact-btn {
            background: none; border: none; color: #ff4444; 
            font-size: 0.5rem; letter-spacing: 2px;
            cursor: pointer; margin-top: 30px; opacity: 0.4;
        }
        .redact-btn:hover { opacity: 1; }

    </style>
</head>
<body>

<div id="cursor"></div>
<div id="cursor-follower"></div>

<section class="hero">
    <div class="hero-label">The Sovereign Estate of</div>
    <h1 class="hero-title">ISA Cultural Fest</h1>
    <div class="hero-label" style="margin-top:20px; letter-spacing: 8px;">MMXXVI Chronicles</div>
</section>

<section class="registry-section">
    <div class="registry-card">
        <h2 class="form-header">The Imperial Registry</h2>
        
        <div id="g_id_onload"
             data-client_id="671163289983-2056vpimutuatgerek6676pr1ob9p1n0.apps.googleusercontent.com"
             data-callback="handleCredentialResponse"
             data-auto_prompt="false">
        </div>
        <div class="g_id_signin" data-type="standard" style="display:flex; justify-content:center; margin-bottom:50px;"></div>

        <div class="input-row">
            <div class="group">
                <label>Origin Department</label>
                <select id="from-dept"></select>
            </div>
            <div class="group">
                <label>Destined Department</label>
                <select id="to-dept"></select>
            </div>
        </div>

        <div class="input-row">
            <div class="group">
                <label>The Recipient</label>
                <input type="text" id="target-name" placeholder="Name of the distinguished...">
            </div>
            <div class="group">
                <label>Archive Search</label>
                <input type="text" id="search" onkeyup="filter()" placeholder="Recall a memory...">
            </div>
        </div>

        <label>The Testimony</label>
        <textarea id="message-text" rows="2" placeholder="Compose your legacy..."></textarea>

        <button class="submit-btn" id="submit-btn" onclick="addEntry()" disabled>ETCH INTO HISTORY</button>
        <p id="auth-status" style="text-align:center; font-size:0.5rem; margin-top:25px; color:var(--gold-dim); letter-spacing: 2px;">AUTHENTICATION REQUIRED TO ACCESS REGISTRY</p>
    </div>
</section>

<div id="feed"></div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
    // FIREBASE DATA (Extracted from your console screenshot)
    const firebaseConfig = {
      apiKey: "AIzaSyBfj4i0quFWPTHCdnC8GT3BSEsKvvvqzRA",
      authDomain: "isa-culturtal-fest-2026.firebaseapp.com",
      databaseURL: "https://isa-culturtal-fest-2026-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "isa-culturtal-fest-2026",
      storageBucket: "isa-culturtal-fest-2026.firebasestorage.app",
      messagingSenderId: "409174792749",
      appId: "1:409174792749:web:d1ea619c1ea6e31706b6a4",
      measurementId: "G-H3KJPEJZ2K"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // ROLES
    const roles = ["PR", "Finance (Sponsorship)", "Co-Presidents", "Helpers", "Activity Booth Hosts", "Activity Performers", "Activity Team", "HR Coordination", "HR Operation", "Secretary", "Lighting & Sound Crew", "Attendees", "Core Council", "Ambassadors"];
    const fromSelect = document.getElementById('from-dept');
    const toSelect = document.getElementById('to-dept');
    roles.forEach(role => {
        fromSelect.add(new Option(role, role));
        toSelect.add(new Option(role, role));
    });

    // CURSOR
    document.addEventListener('mousemove', e => {
        document.getElementById('cursor').style.left = e.clientX + 'px'; 
        document.getElementById('cursor').style.top = e.clientY + 'px';
        document.getElementById('cursor-follower').style.transform = `translate(${e.clientX - 25}px, ${e.clientY - 25}px)`;
    });

    // AUTH
    let currentUser = null;
    function decodeJwtResponse(token) {
        let base64Url = token.split('.')[1];
        let base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        return JSON.parse(window.atob(base64));
    }

    function handleCredentialResponse(response) {
        const payload = decodeJwtResponse(response.credential);
        currentUser = { id: payload.sub, name: payload.name };
        document.getElementById('auth-status').innerText = `RECOGNIZED: ${currentUser.name.toUpperCase()}`;
        document.getElementById('submit-btn').disabled = false;
    }

    // DATABASE
    function addEntry() {
        const targetName = document.getElementById('target-name').value.trim();
        const fromDept = document.getElementById('from-dept').value;
        const toDept = document.getElementById('to-dept').value;
        const message = document.getElementById('message-text').value.trim();

        if(!targetName || !message) return;

        const newKey = database.ref().child('registry').push().key;
        database.ref('registry/' + newKey).set({
            id: newKey, targetName, fromDept, toDept, message,
            author: currentUser.name, authorId: currentUser.id, timestamp: Date.now()
        });

        document.getElementById('target-name').value = '';
        document.getElementById('message-text').value = '';
    }

    function redact(id) {
        if(confirm("Do you wish to strike this from the eternal record?")) database.ref('registry/' + id).remove();
    }

    database.ref('registry').on('value', (snapshot) => {
        const feed = document.getElementById('feed');
        feed.innerHTML = '';
        const data = snapshot.val();
        if (data) {
            Object.values(data).sort((a, b) => b.timestamp - a.timestamp).forEach(item => {
                const isOwner = currentUser && item.authorId === currentUser.id;
                feed.innerHTML += `
                    <div class="feed-item">
                        <div class="meta-header">${item.fromDept.toUpperCase()} // TO // ${item.toDept.toUpperCase()}</div>
                        <div class="quote-text">"${item.message}"</div>
                        <div class="signature-line">For ${item.targetName} â€” Sincerely, ${item.author}</div>
                        ${isOwner ? `<button class="redact-btn" onclick="redact('${item.id}')">[ REDACT ENTRY ]</button>` : ''}
                    </div>`;
            });
        }
    });

    function filter() {
        const term = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.feed-item').forEach(item => {
            item.style.display = item.innerText.toLowerCase().includes(term) ? "block" : "none";
        });
    }
</script>
</body>
</html>
